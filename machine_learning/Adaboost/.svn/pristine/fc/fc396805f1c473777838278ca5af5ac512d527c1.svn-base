% script to graphically report the training and test errors
% as a function of the number of weak hypothesis

% load train and test data
load zip.test;
ziptest = zip;
load zip.train;
% one-vs-three problem
fprintf('Working on the one-vs-three problem...');
subsample = zip(find(zip(:,1)==1 | zip(:,1) == 3),:);
% label digit 1 as +1 and digit 3 as -1
y_tr = subsample(:,1);
idx = logical(y_tr==1);
y_tr(idx) = 1;
y_tr(~idx) = -1;
X_tr = subsample(:,2:257);
% generate test set
testsubsample = ziptest(find(ziptest(:,1)==1 | ziptest(:,1) == 3),:);
y_te = testsubsample(:,1);
idx = logical(y_te==1);
y_te(idx) = 1;
y_te(~idx) = -1;
X_te = testsubsample(:,2:257);
% compute errors for different number of weak hypothesis
num_hyp = 25;
[train_err,test_err] = AdaBoost(X_tr,y_tr,X_te,y_te,num_hyp);
% make plot
figure
num_hyp = [1:1:25];
plot(num_hyp,train_err,'-ro');
title('One-vs-Three Problem');
xlabel('Number of weak hypothesis');
ylabel('Training Error');
figure
num_hyp = [1:1:25];
plot(num_hyp,test_err,'-bx');
title('One-vs-Three Problem');
xlabel('Number of weak hypothesis');
ylabel('Test Error');


% three vs. five problem
fprintf('\nNow working on the three-vs-five problem...\n\n');
subsample = zip(find(zip(:,1)==3 | zip(:,1) == 5),:);
% label digit 3 as +1 and digit 5 as -1
y_tr = subsample(:,1);
idx = logical(y_tr==3);
y_tr(idx) = 1;
y_tr(~idx) = -1;
X_tr = subsample(:,2:257);
% generate test set
testsubsample = ziptest(find(ziptest(:,3)==3 | ziptest(:,1) == 5),:);
y_te = testsubsample(:,1);
idx = logical(y_te==3);
y_te(idx) = 1;
y_te(~idx) = -1;
X_te = testsubsample(:,2:257);
% compute errors for different number of weak hypothesis
num_hyp = 25;
[train_err,test_err] = AdaBoost(X_tr,y_tr,X_te,y_te,num_hyp);
% make plot
figure
num_hyp = [1:1:25];
plot(num_hyp,train_err,'-ro');
title('Three-vs-Five Problem');
xlabel('Number of weak hypothesis');
ylabel('Training Error');
figure
num_hyp = [1:1:25];
plot(num_hyp,test_err,'-bx');
title('Three-vs-Five Problem');
xlabel('Number of weak hypothesis');
ylabel('Test Error');